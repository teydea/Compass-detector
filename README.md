# Детекция направления стрелки компаса

## Описание
Проект для определения направления стрелки компаса (N, S, W, E) с помощью компьютерного зрения и YOLOv8n. Программа извлекает кадры из видео, размечает данные, обучает модель и определяет направление на новых видео.

## Установка
1. Клонировать репозиторий
2. Установить зависимости  ```pip install -r requirements.txt```;
3. Поместить видео в папку ```dataset/videos/```.

## Запуск
### 1. Аннотация данных
```
cd src
python annotate.py
```
Инструкция в окне:
1. Кликните в ЦЕНТРЕ стрелки (зеленая точка)
2. Кликните в КОНЧИКЕ стрелки (красная точка)
3. Нажмите любую клавишу для следующего кадра
4. 'q' для выхода

### 2. Обучение модели
```
cd src
python train.py
```

Модель обучается автоматически, сохраняется в ```models/best.pt```, метрики в ```models/results/```

### 3. Определение направления
```
cd src
python inference.py --video ../dataset/videos/ваше_видео.mp4
```
На видео появится направление стрелки и confidence.

## Примечания
- Все временные файлы (```yolo_data/```, ```runs/```) автоматически
удаляются.
- Модель работает на CPU или GPU автоматически
